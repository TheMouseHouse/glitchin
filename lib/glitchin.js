'use strict';Object.defineProperty(exports,'__esModule',{value:!0}),exports.Glitchin=Glitchin,require('babel-polyfill');var _lodash=require('lodash'),_jimp=require('jimp'),_jimp2=_interopRequireDefault(_jimp),_bluebird=require('bluebird'),_loader=require('./modules/loader'),_render=require('./modules/render');function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function Glitchin(a,b){var c=this;(0,_lodash.isUndefined)(a)||(0,_lodash.isUndefined)(b)||(this.promises=[],this.layers=[],(0,_lodash.each)(a,function(d,e){c.promises.push(new _bluebird.Promise(function(f){new _loader.Loader(d.file).then(function(h){c.layers[e]={params:d,jimp:h},f()}).catch(function(h){console.error(h),f(h)})}))}),_bluebird.Promise.all(this.promises).then(function(){console.log('Images loaded. Glitching...');var d=c.layers[0].jimp.bitmap,e=new _jimp2.default(d.width,d.height,function(f,g){(0,_lodash.isNull)(f)&&((0,_lodash.each)(c.layers.reverse(),function(h){0<h.params.opacity&&(h.jimp.opacity(h.params.opacity/100),g.composite(h.jimp,0,0))}),(0,_render.Render)(g,b.output))})}))}